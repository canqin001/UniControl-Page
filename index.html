<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="description" content="GlueGen">
  <meta name="keywords" content="Image Generation, Multi-modal">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>UniControl: A Unified Diffusion Model for Controllable Visual Generation In the Wild</title>
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>

<body>

  <nav class="navbar" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>
    <div class="navbar-menu">
      <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
        <a class="navbar-item" href="https://github.com/salesforce/UniControl">
          <span class="icon">
            <i class="fas fa-home"></i>
          </span>
        </a>

      </div>

    </div>
  </nav>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">UniControl: A Unified Diffusion Model for Controllable Visual Generation In the Wild</h1>
            <div class="is-size-5 publication-authors">
              <span class="author-block">
               Can Qin</a><sup>1,2,&dagger;</sup>&#8192;
              </span>
              <span class="author-block">
                Shu Zhang</a><sup>1</sup>&#8192;
               </span>
              <span class="author-block">
               Ning Yu</a><sup>1</sup>&#8192;
              </span>
              <span class="author-block">
               Yihao Feng</a><sup>1</sup>&#8192;
              </span>
              <span class="author-block">
                Xinyi Yang</a><sup>1</sup>&#8192;
              </span>
              <span class="author-block">
                Yingbo Zhou</a><sup>1</sup>&#8192;
              </span>
              <span class="author-block">
                Huan Wang</a><sup>1</sup>&#8192;
              </span>
              <span class="author-block">
                Yingbo Zhou</a><sup>1</sup>&#8192;
              </span>
              <span class="author-block">
                Juan Carlos Niebles</a><sup>1</sup>&#8192;
              </span>
              <span class="author-block">
                Caiming Xiong</a><sup>1</sup>&#8192;
              </span>
              <span class="author-block">
                Silvio Savarese</a><sup>1</sup>&#8192;
              </span>
            <!-- </div>
            <div class="is-size-5 publication-authors"> -->
              <span class="author-block">
               Stefano Ermon</a><sup>3</sup>&#8192;
              </span>
              <span class="author-block">
                Yun Fu </a><sup>2</sup>
               </span>
              <span class="author-block">
                Ran Xu</a><sup>1</sup>&#8192;
              </span>
            </div>
            <div class="is-size-5 publication-authors">
              <span><sup>1</sup>Salesforce AI, Palo Alto, CA</span>
            </div>
            <div class="is-size-5 publication-authors">
              <span><sup>2</sup>Northeastern University, Boston, MA&#8192;</span>
            </div>
            <div class="is-size-5 publication-authors">
              <span><sup>3</sup>Stanford University, Palo Alto, CA</span>
            </div>

            <div style="font-size:15px">
              <span><sup>&dagger;</sup>Work done when Can Qin was an intern at Salesforce AI&#8192;</span></br>
            </div>


    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column is-full-width">
          <p align="center">
            <a><img src="figs/logo.svg" width="500" ></a>
          </p>
        </div>
      </div>
    </div>



            <div class="column has-text-centered">
              <div class="publication-links">
                <!-- PDF Link. -->
                <span class="link-block">
                  <a href="https://arxiv.org/pdf/2305.11147.pdf"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                    </span>
                    <span>PDF</span>
                  </a>
                </span>
                <span class="link-block">
                  <a href="https://arxiv.org/abs/2305.11147" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="ai ai-arxiv"></i>
                    </span>
                    <span>ArXiv</span>
                  </a>
                </span>
                <!-- Code Link. -->
                <span class="link-block">
                  <a href="https://github.com/salesforce/UniControl"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>


   <section class="section" id="Gradio Demo Video">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column is-full-width">
           <h2 class="title is-3" align='center'>Gradio Demo Video</h2>
          <p align="center">
           <video controls width="900">
             <source src="figs/UniControl-Demo-All.mp4" type="video/mp4">
           </video>
          </p>
        </div>
      </div>
    </div>
</section>

  
  <section class="hero teaser">
    <div class="container is-max-desktop">
      <div class="hero-body">
         <h2 class="title is-3" align='center'>Gradio Demo Video</h2>
        <div align='center'>
          <a><img src="figs/demo_all_v2_lr.svg" width="95%" height="120%"  ></a>
        </div>
        <div class="content has-text-justified">
          UniControl is trained with multiple tasks with a unified model, and it further demonstrates promising capability in zero-shot tasks generalization with visual example results shown above.
        </div>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container is-max-desktop">
      <!-- Abstract. -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Abstract</h2>
          <div class="content has-text-justified">
            Achieving machine autonomy and human control often represent divergent objectives in the design of interactive AI systems. Visual generative foundation models such as Stable Diffusion show promise in navigating these goals, especially when prompted with arbitrary languages. However, they often fall short in generating images with spatial, structural, or geometric controls. The integration of such controls, which can accommodate various visual conditions in a single unified model, remains an unaddressed challenge. In response, we introduce UniControl, a new generative foundation model that consolidates a wide array of controllable condition-to-image (C2I) tasks within a singular framework, while still allowing for arbitrary language prompts. UniControl enables pixel-level-precise image generation, where visual conditions primarily influence the generated structures and language prompts guide the style and context. To equip UniControl with the capacity to handle diverse visual conditions, we augment pretrained text-to-image diffusion models and introduce a task-aware HyperNet to modulate the diffusion models, enabling the adaptation to different C2I tasks simultaneously. Trained on nine unique C2I tasks, UniControl demonstrates impressive zero-shot generation abilities with unseen visual conditions. Experimental results show that UniControl often surpasses the performance of single-task-controlled methods of comparable model sizes. This control versatility positions UniControl as a significant advancement in the realm of controllable visual generation. 
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="hero teaser">
    <div class="container is-max-desktop">
      <div class="hero-body">
        <div align='center'>
          <a><img src="figs/method.svg"  width="95%" height="120%" ></a>
        </div>
        <div class="content has-text-justified">
          This figure shows our proposed UniControl method. To accommodate diverse tasks, we've designed a Mixture of Experts (MOE) Adapter, containing roughly ~70K #params for each task, and a Task-aware HyperNet (~12M #params) to modulate N (i.e., 7) zero-conv layers. This structure allows for multi-task functionality within a singular model, significantly reducing the model size compared to an equivalent stack of single-task models, each with around 1.4B #params.
        </div>
      </div>
    </div>
  </section>


  <section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column is-full-width">

          <h2 class="title is-3" align='center'>Pre-training Tasks Results</h2>

          <p align="center">
            <a><img src="figs/main_result.svg" width="95%" height="120%" ></a>
          </p>
          Visual comparison between official or re-implemented task-specific ControlNet and our proposed model. The example data is collected from our testing set sampled from COCO and Laion.
        </div>
      </div>
    </div>
  </section>


  <section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column is-full-width">

          <h2 class="title is-3" align='center'> Zero-shot Tasks Results</h2>

          <p align="center">
            <a><img src="figs/zero_shot_result_all.svg" width="95%" height="120%" ></a>
          </p>
          (a)-(b): Example results of UniControl over hybrid  (unseen combination) conditions with key words "background" and "foreground" attached in prompts. (c)-(e): Example results of UniControl on three unseen tasks (deblurring, colorization, inpainting)

        </div>
      </div>
    </div>
  </section>



<!-- <a href="figs/gradio_video.mp4" title="APP Demo Video">Demo Video</a> -->


  
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>@article{qin2023unicontrol,
  title={UniControl: A Unified Diffusion Model for Controllable Visual Generation In the Wild},
  author={Qin, Can and Zhang, Shu and Yu, Ning and Feng, Yihao and Yang, Xinyi and Zhou, Yingbo and Wang, Huan and Niebles, Juan Carlos and Xiong, Caiming and Savarese, Silvio and others},
  journal={arXiv preprint arXiv:2305.11147},
  year={2023}
}</code></pre>
    </div>
  </section>


  <footer class="footer">
    <div align="center" class="container">
      <div class="columns is-centered">
        <div class="content">
          This website is borrowed from <a href="https://github.com/nerfies/nerfies.github.io">nerfies</a>.
        </div>
      </div>
    </div>
  </footer>

</body>

</html>
